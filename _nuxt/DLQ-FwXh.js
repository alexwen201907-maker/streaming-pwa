import{d as R,o as S,c as U,z as n,A as e,Q as A,R as D,N as E,B as _,Y as k,l,i as b,y as i,T as I}from"./DE4dX8_2.js";import{u as K}from"./YB4b_Ydt.js";const P={class:"topbar"},q={class:"topbar-inner"},z={style:{display:"flex",gap:"10px","align-items":"center"}},Q=["placeholder"],W=["src"],Y={key:0,class:"menu"},j={class:"menu-head"},F=["src"],G={style:{"min-width":"0"}},H={class:"menu-name"},J={class:"menu-email"},Z=R({__name:"TopBar",props:{modelValue:{},placeholder:{},brandTo:{}},emits:["update:modelValue","search"],setup(d,{emit:y}){const m=d,v=y,c=I(),o=K(),p=l(()=>o.isLoggedIn),B=l(()=>o.username||"已登录"),C=l(()=>o.email||""),f=l(()=>o.avatarUrl||"https://images.unsplash.com/photo-1520975958225-20a2fcd6b1d9?w=128&q=80&auto=format&fit=crop"),r=l({get:()=>m.modelValue,set:a=>v("update:modelValue",a)});function x(){v("search",r.value)}function V(){c.push(m.brandTo||"/")}const s=b(!1),h=b(null);function w(){u(),c.push("/login")}function T(){s.value=!s.value}function u(){s.value=!1}function g(a){if(!s.value)return;const t=h.value;t&&a.target instanceof Node&&!t.contains(a.target)&&u()}function L(){u(),c.push("/profile")}function M(){u(),o.logout(),c.replace("/login")}return S(()=>document.addEventListener("click",g)),U(()=>document.removeEventListener("click",g)),(a,t)=>(i(),n("div",P,[e("div",q,[e("div",{class:"brand",onClick:V},"Streaming PWA"),e("div",z,[A(e("input",{class:"search","onUpdate:modelValue":t[0]||(t[0]=N=>r.value=N),placeholder:d.placeholder,onKeydown:E(x,["enter"])},null,40,Q),[[D,r.value]]),e("div",{class:"userbox",ref_key:"userBoxRef",ref:h},[e("button",{class:"avatar-btn",onClick:T,"aria-label":"User menu"},[e("img",{class:"avatar",src:f.value,alt:"avatar"},null,8,W)]),s.value?(i(),n("div",Y,[e("div",j,[e("img",{class:"avatar",src:f.value,alt:"avatar"},null,8,F),e("div",G,[e("div",H,_(B.value),1),e("div",J,_(C.value),1)])]),t[1]||(t[1]=e("div",{class:"menu-split"},null,-1)),p.value?(i(),n("button",{key:0,class:"menu-item",onClick:L},"个人")):(i(),n("button",{key:1,class:"menu-item",onClick:w},"去登录")),p.value?(i(),n("button",{key:2,class:"menu-item danger",onClick:M},"退出")):k("",!0)])):k("",!0)],512)])])]))}});export{Z as _};
